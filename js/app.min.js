var Vector=function(){function e(e,t){this.x=e||0,this.y=t||0}return e.make=function(t,n){return new e(n.x-t.x,n.y-t.y)},e.size=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},e.normalize=function(t){var n=e.size(t);return t.x/=n,t.y/=n,t},e.incidence=function(e,t){var n=Math.atan2(t.y,t.x)-Math.atan2(e.y,e.x);return n},e.distance=function(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))},e.cross=function(e,t){return e.x*t.y-e.y*t.x},e.difference=function(t,n){return new e(n.x-t.x,n.y-t.y)},e.prototype={size:function(){return e.size(this)},normalize:function(){return e.normalize(this)},incidence:function(t){return e.incidence(this,t)},cross:function(t){return e.cross(this,t)},towards:function(e,t){return t=t||.125,this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},add:function(e){return this.x+=e.x,this.y+=e.y,this},friction:function(e){return this.x*=e,this.y*=e,this},copy:function(t){return new e(this.x,this.y)},toString:function(){return"{"+this.x+","+this.y+"}"}},e}(),Utils=function(){function e(e,t){var n=new Vector;if("touchstart"==e.type||"touchmove"==e.type||"touchend"==e.type||"touchcancel"==e.type){var r=null,o=e.originalEvent?e.originalEvent:e,a=o.touches.length?o.touches:o.changedTouches;a&&a.length&&(r=a[0]),r&&(n.x=r.pageX,n.y=r.pageY)}else"click"!=e.type&&"mousedown"!=e.type&&"mouseup"!=e.type&&"mousemove"!=e.type&&"mouseover"!=e.type&&"mouseout"!=e.type&&"mouseenter"!=e.type&&"mouseleave"!=e.type||(n.x=e.pageX,n.y=e.pageY);return t&&(n.s=Vector.difference(t,n)),n.type=e.type,n}function t(e,t){var n=window.scrollY||window.pageYOffset||document.body.scrollTop+(document.documentElement&&document.documentElement.scrollTop||0),r=e[0].getBoundingClientRect(),o=new Vector(r.left,r.top+n);return Vector.difference(o,t)}function n(e,t){var n,r;for(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].some(function(e){return"function"==typeof document.body[e]?(n=e,!0):!1});null!==e;){if(r=e.parentElement,null!==r&&r[n](t))return r;e=r}return null}function r(e,t,n){n=n||"id";var r=-1;if(e)for(var o=0,a=e.length;a>o;){if(e[o]&&e[o][n]===t[n]){r=o;break}o++}return r}function o(e,t){var n=-1;if(e)for(var r=0,o=e.length;o>r;){if(e[r]===t){n=r;break}r++}return-1!==n?(e.splice(n,1),t):null}function a(e,t){t=t||0,e-=60*t*1e3;var n=(parseInt(e%1e3/100),parseInt(e/1e3%60)),r=parseInt(e/6e4%60),o=parseInt(e/36e5%24),o=10>o?"0"+o:o,r=10>r?"0"+r:r,n=10>n?"0"+n:n;return o+":"+r+":"+n}function i(e,t){t=t||0,e-=60*t*1e3;var n=(parseInt(e%1e3/100),parseInt(e/1e3%60)),r=parseInt(e/6e4%60),o=parseInt(e/36e5%24);return(o?o+"h ":"")+(r?r+"' ":"")+(n?n+"'' ":"")}function s(e,t,n){var r,o,a,i=null,s=0;n||(n={});var u=function(){s=n.leading===!1?0:l(),i=null,a=e.apply(r,o),i||(r=o=null)};return function(){var c=l();s||n.leading!==!1||(s=c);var h=t-(c-s);return r=this,o=arguments,0>=h||h>t?(i&&(clearTimeout(i),i=null),s=c,a=e.apply(r,o),i||(r=o=null)):i||n.trailing===!1||(i=setTimeout(u,h)),a}}function u(){}!function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var r=(new Date).getTime(),o=Math.max(0,16-(r-e)),a=window.setTimeout(function(){t(r+o)},o);return e=r+o,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}();var c=function(){var e="transform",t="webkitTransform",n=document.createElement("DIV");return"undefined"!=typeof n.style[e]?["webkit","moz","o","ms"].every(function(t){var r="-"+t+"-transform";return"undefined"!=typeof n.style[r]?(e=r,!1):!0}):e="undefined"!=typeof n.style[t]?"-webkit-transform":void 0,e}(),l=Date.now||function(){return(new Date).getTime()},h=function(){function e(){this.props={scale:1,hoverScale:1,currentScale:1}}return e.prototype={set:function(e){var t=[];for(var n in this)"props"!==n&&t.push(n+":"+this[n]);e.style.cssText=t.join(";")+";"},transform:function(e){this[u.transformProperty]=e},transformOrigin:function(e,t){this[u.transformProperty+"-origin-x"]=Math.round(1e3*e)/1e3+"%",this[u.transformProperty+"-origin-y"]=Math.round(1e3*t)/1e3+"%"}},e}(),p=function(){function e(){}return e._set=function(e,t,n){if(n){var r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3);var o="; expires="+r.toGMTString()}else var o="";window.document.cookie=e+"="+t+o+"; path=/"},e.set=function(t,n,r){try{var o=[],a=JSON.stringify(n,function(e,t){if("pool"!==e){if("object"==typeof t&&null!==t){if(-1!==o.indexOf(t))return;o.push(t)}return t}});o=null,e._set(t,a,r)}catch(i){console.log("Cookie.set.error serializing",t,n,i)}},e.get=function(e){for(var t=e+"=",n=window.document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t)){var a=o.substring(t.length,o.length),i=null;try{i=JSON.parse(a)}catch(s){console.log("Cookie.get.error parsing",key,s)}return i}}return null},e["delete"]=function(t){e._set(t,"",-1)},e.on=function(t){function n(){if(i>s)o.reject("timeout");else{var u=e.get(t);u?o.resolve(u):(i+=a,r=setTimeout(n,a))}}var r,o=$q.defer(),a=1e3,i=0,s=6e4;return n(),o.promise},e}(),f=function(){function e(){}function t(){var e=!1;try{e="localStorage"in window&&null!==window.localStorage,e?(window.localStorage.setItem("test","1"),window.localStorage.removeItem("test")):e=!1}catch(t){e=!1}return e}return e.isSupported=t(),e.isSupported?(e.set=function(e,t){try{var n=[],r=JSON.stringify(t,function(e,t){if("pool"!==e){if("object"==typeof t&&null!==t){if(-1!==n.indexOf(t))return;n.push(t)}return t}});n=null,window.localStorage.setItem(e,r)}catch(o){console.log("LocalStorage.set.error serializing",e,t,o)}},e.get=function(e){var t=null;if(void 0!==window.localStorage[e])try{t=JSON.parse(window.localStorage[e])}catch(n){console.log("LocalStorage.get.error parsing",e,n)}return t},e["delete"]=function(e){window.localStorage.removeItem(e)},e.on=function(e){function t(t){if(clearTimeout(n),t.originalEvent.key==e)try{var o=JSON.parse(t.originalEvent.newValue);r.resolve(o)}catch(t){console.log("LocalStorage.on.error parsing",e,t),r.reject("error parsing "+e)}}var n,r=$q.defer(),o=6e4;return window.addEventListener?window.addEventListener("storage",t,!1):window.attachEvent("onstorage",t),n=setTimeout(function(){r.reject("timeout")},o),r.promise}):(console.log("LocalStorage.unsupported switching to cookies"),e.set=p.set,e.get=p.get,e["delete"]=p["delete"],e.on=p.on),e}();return u.transformProperty=c,u.getTouch=e,u.getRelativeTouch=t,u.getClosest=n,u.indexOf=r,u.removeValue=o,u.parseHour=a,u.parseTime=i,u.throttle=s,u.Style=h,u.LocalStorage=f,u.Cookie=p,u}(),app=angular.module("app",["ngRoute"]);app.config(["$httpProvider","$routeProvider","$locationProvider",function(e,t,n){t.when("/",{state:"home",title:"Home",templateUrl:"partial/home",controller:"HomeCtrl"}).when("/about",{state:"about",title:"About",templateUrl:"partial/about",controller:"AboutCtrl"}).when("/contact",{state:"contact",title:"Contact",templateUrl:"partial/contact",controller:"ContactCtrl"}),t.otherwise("/"),n.html5Mode(!0)}]),app.run(["$rootScope",function(e){var t=null;e.$on("$routeChangeSuccess",function(e,n,r){t=n.$$route.state,console.log("$routeChangeSuccess",t),setTimeout(function(){void 0!==document.body.scrollTop?document.body.scrollTop=0:document.documentElement.scrollTop=0},100)}),e.isState=function(e){return e===t}}]),app.animation(".navigation-animation",function(e,t){function n(){return!a}function r(){return o.isForward}var o=null,a=null,i={type:dynamics.bezier,points:[{x:0,y:0,cp:[{x:.509,y:.007}]},{x:1,y:1,cp:[{x:.566,y:.997}]}],duration:500};return e.$on("$routeChangeSuccess",function(e,t,n){o=n.$$route,a=t.$$route}),{enter:function(e,t){if(n())dynamics.css(e[0],{translateY:0,opacity:0,scale:1.2}),dynamics.animate(e[0],{translateY:0,opacity:1,scale:1},i);else if(r()){var o=e[0].offsetWidth;dynamics.css(e[0],{translateX:-o}),dynamics.animate(e[0],{translateX:0},i)}else{var o=e[0].offsetWidth;dynamics.css(e[0],{translateX:o}),dynamics.animate(e[0],{translateX:0},i)}t()},leave:function(e,t){if(r()){var n=e[0].offsetWidth;dynamics.css(e[0],{translateX:0}),dynamics.animate(e[0],{translateX:n},i)}else{var n=e[0].offsetWidth;dynamics.css(e[0],{translateX:0}),dynamics.animate(e[0],{translateX:-n},i)}setTimeout(t,1e3)}}}),app.directive("validateType",function(){return{require:"ngModel",link:function(e,t,n,r){var o=n.validateType;switch(o){case"number":r.$parsers.unshift(function(e){return r.$setValidity(o,Number(e).toString()==String(e)),e});break;case"array":r.$validators.required=function(){var e=r.$modelValue;if(!e)return!1;var o=void 0!==n.label?n.label:"name",a="";return angular.forEach(e,function(e,t){a+=(t>0?", ":"")+e[o]}),t[0].value=a,e.length>0},e.$watch(function(){return r.$modelValue&&r.$modelValue.length},function(){r.$validate()})}}}}),app.directive("controlMultipleSelect",[function(){return{require:"ngModel",template:'<ul><li ng-repeat="item in source track by $index" ng-click="add($index)" ng-class="{ active: has($index) }"><span ng-bind="item[label]"></span></li></ul>',scope:{source:"=controlMultipleSelect",label:"@",key:"@"},link:function(e,t,n,r){e.add=function(t){var r=e.$parent.$eval(n.ngModel);if(r){var o=e.indexOf(t);-1!==o?r.splice(o,1):"true"===n.number?r.push(e.source[t][e.key]):r.push(e.source[t])}},e.indexOf=function(t){var r=-1,o=e.$parent.$eval(n.ngModel);return o&&angular.forEach(o,function(o,a){"true"===n.number?o===e.source[t][e.key]&&(r=a):o[e.key]===e.source[t][e.key]&&(r=a)}),r},e.has=function(t){var n=e.indexOf(t);return-1!==n},t.on("click",function(){t.addClass("active")})}}}]),app.directive("switcher",["$timeout","$sce",function(e,t){var n=0;return{restrict:"EA",require:"ngModel",scope:{model:"=ngModel",valueTrue:"=?",valueFalse:"=?",labelTrue:"@?",labelFalse:"@?",change:"=?ngChange",isDisabled:"=?ngDisabled"},template:function(e,t){var r=t.name||"switcher"+ ++n;return'<div class="switcher" ng-class="{ active: isActive, disabled: isDisabled }">   <span class="switcher-label false" ng-bind-html="trust(labelFalse)" ng-click="SetSwitch(false)"></span>   <label class="switcher-line">       <input id="'+r+'" name="'+r+'" type="checkbox" ng-model="isActive" ng-disabled="isDisabled" ng-change="onChange()">   </label>   <span class="switcher-label true" ng-bind-html="trust(labelTrue)" ng-click="SetSwitch(true)"></span></div>'},link:function(n,r,o,a){var i=r[0].querySelector("input"),s={valueTrue:!0,valueFalse:!1,isDisabled:!1},u={labelTrue:"On",labelFalse:"Off"};angular.forEach(s,function(e,t){angular.isDefined(n[t])||(n[t]=e)}),angular.forEach(u,function(e,t){angular.isDefined(n[t])||(o[t]=e)}),n.trust=function(e){return t.trustAsHtml(e)},n.SetSwitch=function(e){console.log("switcher.set",e),n.isDisabled||i.checked==e||(n.isActive=i.checked=e,n.onChange())},n.onChange=function(){console.log("switcher.onChange",i.checked,n.change);var t=n.model,r=i.checked?n.valueTrue:n.valueFalse;n.model=r,angular.isFunction(n.change)&&e(function(){n.change(r,t)})},n.$watch("model",function(e){console.log("switcher.model",e),n.isActive=e==n.valueTrue,i.checked!==n.isActive&&(i.checked=n.isActive)})}}}]),app.directive("control",["$parse",function(e){var t=0;return{restrict:"A",replace:!0,template:function(e,n){var r=n.form||"Form",o=n.title||"Untitled",a=n.placeholder||o,i=o.replace(/[^0-9a-zA-Z]/g,"").split(" ").join("")+ ++t,s=r+"."+i,u=' ng-focus="'+s+'.hasFocus=true"',c=' ng-blur="'+s+'.hasFocus=false"',l=' ng-mouseleave="'+s+'.hasFocus=false"',h=u+c,p="",f=n.label?n.label:"name",g=n.key?n.key:"id",d=n.model;if(n.required){switch(p='<span ng-messages="'+(n.readonly?"":"("+r+".$submitted || "+s+".$touched) && ")+r+"."+i+'.$error" role="alert"><span ng-message="required" class="label-error animated flash"> &larr; required</span>',n.control){case"password":p+='<span ng-message="minlength" class="label-error animated flash"> &larr; at least 6 chars</span>';break;case"email":p+='<span ng-message="email" class="label-error animated flash"> &larr; incorrect</span>';break;case"number":p+='<span ng-message="number" class="label-error animated flash"> &larr; enter a valid number</span>'}void 0!==n.match&&(p+='<span ng-message="match" class="label-error animated flash"> &larr; not matching</span>'),p+="</span>"}else p="switch"!==n.control?" (optional)":"";var m="<div "+(n.readonly?' class="readonly" ':"")+' ng-class="{ focus: '+s+".hasFocus, success: "+s+".$valid, error: "+s+".$invalid && (form.$submitted || "+s+".$touched), empty: !"+s+'.$viewValue }"><label for="'+i+'" class="control-label">'+o+p+"</label>";switch(n.control){case"switch":return m+='<div class="switcher" switcher name="'+i+'" ng-model="'+d+'" value-true="'+n.value+'" label-true="" label-false=""'+(n.onChanged?' ng-change="'+n.onChanged+'"':"")+"></switcher>";case"checkbox":m='<div class="checkbox">',m+='<span class="checkbox-label">'+o+p+"</span>",m+='<span class="switch"><input id="'+i+'" name="'+i+'" type="checkbox" ng-model="'+d+'" '+(n.required?'required="true"':"")+' class="toggle toggle-round-flat"><label for="'+i+'"></label></span>',m+="</div>";break;case"select":var v=n.number?"item."+g+" as item."+f+" for item in "+n.source:"item."+f+" for item in "+n.source+" track by item."+g;m+='<select name="'+i+'" class="form-control" ng-model="'+d+'" ng-options="'+v+'" '+(n.number?"convert-to-number":"")+" "+(n.required?'required="true"':"")+'><option value="" disabled selected hidden>'+a+"</option></select>";break;case"multiple-select":var v=(n.number?"item."+g:"item",n.number?"item."+g+" as item."+f+" for item in "+n.source:"item."+f+" for item in "+n.source+" track by item."+g);m+="<div "+l+">",m+='<input name="'+i+'" class="form-control" ng-model="'+d+'" validate-type="array" placeholder="'+a+'" type="data" readonly '+u+">",m+='<div control-multiple-select="'+n.source+'" ng-model="'+d+'" label="'+f+'" key="'+g+'" number="'+Boolean(n.number)+'" '+(n.all?'all="true"':"")+"></div>",m+="</div>";break;case"autocomplete":var y=n.canCreate?n.canCreate:!1,b=n.flatten?n.flatten:!1,w=n.queryable?n.queryable:!1,x=n.onSelected?' on-selected="'+n.onSelected+'"':"";m+='<input name="'+i+'" ng-model="'+d+'" type="hidden" '+(n.required?"required":"")+">",m+='<div control-autocomplete="'+n.source+'" model="'+d+'" label="'+f+'"  key="'+g+'" can-create="'+y+'" flatten="'+b+'" queryable="'+w+'" placeholder="'+a+'" on-focus="'+s+'.hasFocus=true" on-blur="'+s+'.hasFocus=false"'+x+"></div>";break;case"textarea":m+='<textarea name="'+i+'" class="form-control" ng-model="'+d+'"'+(n.options?' ng-model-options="'+n.options+'" ':"")+' placeholder="'+a+'" '+(n.required?"required":"")+' rows="'+(n.rows?n.rows:"1")+'"'+h+"></textarea>";break;case"datetime-local":a==o?a="yyyy-MM-ddTHH:mm:ss":null,m+='<input name="'+i+'" class="form-control" ng-model="'+d+'"'+(n.options?' ng-model-options="'+n.options+'" ':"")+' placeholder="'+a+'" type="datetime-local"'+(n.required?" required":"")+(n.readonly?" readonly":"")+h+">";break;case"password":m+='<input name="'+i+'" class="form-control" ng-model="'+d+'"'+(n.options?' ng-model-options="'+n.options+'" ':"")+' placeholder="'+a+'" type="password" ng-minlength="6" '+(n.required?"required":"")+h+">";break;case"email":m+='<input name="'+i+'" class="form-control" ng-model="'+d+'"'+(n.options?' ng-model-options="'+n.options+'" ':"")+' placeholder="'+a+'" type="email" '+(n.required?"required":"")+h+">";break;case"number":m+='<input name="'+i+'" class="form-control" ng-model="'+d+'"'+(n.options?' ng-model-options="'+n.options+'" ':"")+' placeholder="'+a+'" type="text"'+(n.required?" required":"")+(n.readonly?" readonly":"")+h+' validate-type="number">';break;case"text":default:m+='<input name="'+i+'" class="form-control" ng-model="'+d+'"'+(n.options?' ng-model-options="'+n.options+'" ':"")+' placeholder="'+a+'" type="text"'+(n.required?" required":"")+(n.readonly?" readonly":"")+h+">"}return m},link:function(e,t,n,r){}}}]),app.directive("controlAutocomplete",["$parse","$window","$timeout",function(e,t,n){var r=5;return{restrict:"A",scope:{service:"=controlAutocomplete",canCreate:"=",flatten:"=",queryable:"=",model:"=",label:"@",key:"@"},template:function(e,t){var n="<div>";return n+='   <input class="form-control" ng-model="phrase" ng-model-options="{ debounce: 150 }" placeholder="'+t.placeholder+'" type="text" ng-focus="onFocus()">',n+='   <ul class="form-autocomplete" ng-show="items.length">',n+='       <li ng-repeat="item in items" ng-class="{ active: active == $index }" ng-click="onSelect(item)">',n+='           <span>{{item.NameA}}<span class="token">{{item.NameB}}</span>{{item.NameC}}</span>',n+="       </li>",n+="   </ul>",n+="</div>"},link:function(o,a,i,s){function u(){return o.model?o.flatten?o.model:o.model[P]:null}function c(e){o.items.length=0,o.count=0,o.phrase=e||null,T.val(o.phrase)}function l(){var e=null;return-1!=o.active&&o.items.length>o.active&&(e=o.items[o.active]),e}function h(e){o.canCreate&&(o.flatten?C===P&&(o.model=e):(o.model={},o.model[P]=e))}function p(){var e=l();e&&o.onSelect(e),o.$apply()}function f(){o.active--,o.active<0&&(o.active=o.items.length-1),o.$apply()}function g(){o.active++,0==o.items.length?o.active=-1:o.active>=o.items.length&&(o.active=0),o.$apply()}function d(e){o.items=e.items,o.count=e.count,angular.forEach(o.items,function(e,t){var n=e[P],r=n.toLowerCase().indexOf(o.phrase.toLowerCase());e.NameA=n.substr(0,r),e.NameB=n.substr(r,o.phrase.length),e.NameC=n.substr(r+o.phrase.length,n.length-(r+o.phrase.length))})}function m(e){var t=0,n=[];o.phrase.length>1&&angular.forEach(e.items,function(e,a){var i=e[P];-1!==i.toLowerCase().indexOf(o.phrase.toLowerCase())&&(n.length<r&&n.push(e),t++)}),d({count:t,items:n})}function v(){o.phrase=T.val(),o.active=-1,h(o.phrase),o.queryable?o.service.setPhrase(o.phrase).then(function(e){o.items=e.items,o.count=e.count},function(e){console.log("Search.queryable.error",o.phrase,e)})["finally"](function(){}):(m({count:o.service.length,items:o.service}),o.$apply())}function y(e){switch(e.keyCode){case 9:case 13:if(p(),o.items.length)return e.preventDefault?e.preventDefault():null,!1;break;case 38:f();break;case 40:g()}}function b(e){switch(e.keyCode){case 9:case 13:break;case 39:break;case 37:break;case 38:break;case 40:break;default:v.call(this)}}function w(e){return"touchend"==e.type&&angular.element(t).off("mouseup",w),null===Utils.getClosest(e.target,"[control-autocomplete]")&&o.$apply(function(){o.onBlur()}),!0}function x(){T.on("keydown",y),T.on("keyup",b),angular.element(t).on("mouseup touchend",w)}function k(){T.off("keydown",y),T.off("keyup",b),angular.element(t).off("mouseup touchend",w)}function S(){M||(x(),M=!0)}var $=e(i.onSelected),T=a.find("input"),P=o.label?o.label:"name",C=o.key?o.key:"id";o.phrase=u(),o.count=0,o.items=[],o.active=-1,o.maxItems=o.maxItems||Number.POSITIVE_INFINITY,o.onFocus=function(){void 0!==i.onFocus&&o.$parent.$eval(i.onFocus),T.val()===u()&&T.val(null)},o.onBlur=function(){void 0!==i.onBlur&&o.$parent.$eval(i.onBlur),c(u())},o.onSelect=function(e){o.queryable?o.service.setItem(e).then(function(e){$({$item:e},o.$parent,{$event:{}}),n(function(){o.flatten?o.model=e[C]:(o.model=o.model||{},angular.extend(o.model,e)),o.onBlur()},1)}):($({$item:e},o.$parent,{$event:{}}),o.flatten?o.model=e[C]:(o.model=o.model||{},angular.extend(o.model,e)),o.onBlur())},o.$on("$destroy",function(){k()});var M=!1;o.$watch("service",function(e){e&&(e.length||o.queryable)&&S()}),o.$watchCollection("model",function(e){e&&(o.flatten&&P===C?(o.phrase=e,T.val(o.phrase)):e[P]&&(o.phrase=e[P],T.val(o.phrase)))})}}}]),app.factory("Config",["$http",function(e){return e.get("config.json").then(function(e){angular.extend(this,e.data)}.bind(this)),this}]),app.factory("Model",[function(){function e(e){e?angular.extend(this,e):null}return e.prototype={toString:function(){return"Model"}},e}]),app.factory("Models",["$q","$http","Model",function(e,t,n){function r(){}return r.get=function(){var r=e.defer();return t.get(APP.API+"/api/models").then(function(e){var t=[];angular.forEach(e.data,function(e){t.push(new n(e))}),r.resolve(t)},function(e){r.reject(e)}),r.promise},r}]),app.factory("AuthInterceptorService",["$q","$rootScope","$window","$location","LocalStorage",function(e,t,n,r,o){return{isAuthorizedOrGoTo:function(t){var n=e.defer(),a=o.get("authorization");return a&&a.created_at+a.expires_in<(new Date).getTime()?n.resolve(a):(n.reject({status:"unauthorized"}),r.path(t)),n.promise},isAuthorized:function(){var e=o.get("authorization");return e&&e.created_at+e.expires_in<(new Date).getTime()},request:function(e){var t=o.get("authorization");return t&&t.created_at+t.expires_in<(new Date).getTime()&&(e.headers=e.headers||{},e.headers.Authorization="Bearer "+t.access_token),e},response:function(t){return t||e.when(t)},responseError:function(n){switch(n.status){case 400:var a=[];if(n.data){a.push(n.data.Message);for(var i in n.data.ModelState)for(var s=0;s<n.data.ModelState[i].length;s++)a.push(n.data.ModelState[i][s])}else a.push("Server error");n.Message=a.join(" "),t.httpError=n,t.$broadcast("onHttpInterceptorError",n);break;case 404:n.Message="Not found",t.httpError=n,t.$broadcast("onHttpInterceptorError",n);break;case 500:t.httpError=n,t.$broadcast("onHttpInterceptorError",n);break;case 401:o["delete"]("authorization"),o["delete"]("user"),r.path("/signin")}return e.reject(n)},signOut:function(){o["delete"]("authorization"),o["delete"]("user"),o["delete"]("CampagnoloToken"),o["delete"]("GoogleToken"),o["delete"]("StravaToken"),o["delete"]("FacebookToken"),o["delete"]("GarminToken")}}}]),app.factory("Users",["$q","$http","$httpAsync","$location","$timeout","APP","LocalStorage","AuthInterceptorService","User",function(e,t,n,r,o,a,i,s,u){function c(){}var l=null;return c.prototype={},c.current=function(){return c.get()},c.set=function(e){return i.set("user",e),l=e?new u(e):null,a.USER=l,l},c.get=function(){if(null!==l)return l;var e=i.get("user");return e?(l=new u(e),a.USER=l,l):null},c.getCurrentUser=function(){var n=e.defer();return l?n.resolve(l):t.get(a.API+"/api/v1/users/me").then(function(e){e&&e.data?n.resolve(c.set(e.data)):n.resolve(c.set(null))},function(e){n.reject(e)}),n.promise},c.isAuthorizedOrGoTo=function(t){var n=e.defer();return s.isAuthorized()?c.getCurrentUser().then(function(e){e?n.resolve(e):(n.reject(),r.path(t))},function(e){n.reject(e),r.path(t)}):(n.reject(null),r.path(t)),n.promise},c.signOut=function(){var t=e.defer();return c.set(null),s.signOut(),t.resolve(),t.promise},c}]),app.factory("DataFilter",[function(){function e(e){e?angular.extend(this,e):null}return e.prototype={getSearchParams:function(e){var t=[];if(e)for(var n in e)t.push({name:n,value:e[n]});return t},getParams:function(e,t){var n,r={};for(var o in this)"dateFrom"===o||"dateTo"===o||"status"===o?(n=this[o],void 0!==n&&(r[o]=n)):"search"===o&&(r[o]=JSON.stringify(this.getSearchParams(this[o]),null,""));return r.page=e.page,r.size=e.size,r.infinite=t,r}},e}]),app.factory("DataSource",["$q","$http","$httpAsync","$timeout","$rootScope","DataFilter",function(e,t,n,r,o,a){function i(e){this.busy=!1,this.error=!1,this.size=10,this.maxPages=10,this.rows=[],this.filters={},this.service={url:"/api/items/paging",resolve:function(e,t){angular.forEach(e,function(e){this.push(e)},t)}},e?angular.extend(this,e):null,this.filters=new a(this.filters),this.service.uri.paging===!1&&(this.get=function(e,t){this.busy=!0,this.error=!1,r(function(){t?null:this.rows.length=0,this.service.resolve(this.rows),this.page=1,this.pages=2,this.count=this.rows.length,this.pagination=this.getPages(),this.busy=!1,o.$broadcast("onDataSourceUpdate",this),e.resolve(this.rows)}.bind(this),1e3)}),this.flush()}var s=Number.POSITIVE_INFINITY;return i.prototype={flush:function(){this.pages=s,this.page=1,this.count=0,this.opened=null},resolve:function(e){var t=e.headers("X-Pagination"),n=t?JSON.parse(t):null;n?(this.page=n.page,this.size=n.size,this.pages=n.pages,this.count=n.count):(this.page=0,this.size=n.size,this.pages=0,this.count=0),this.pagination=this.getPages()},get:function(e,t){this.busy=!0,this.error=!1,n.get(this.service.uri.paging,{params:this.filters.getParams(this)}).then(function(n){this.resolve(n),t?null:this.rows.length=0,this.service.resolve(n.data,this.rows),o.$broadcast("onDataSourceUpdate",this),e.resolve(this.rows)}.bind(this),function(t){console.log("DataSource.error",t),this.error=!0,e.reject(t)}.bind(this))["finally"](function(){r(function(){this.busy=!1}.bind(this),1e3)}.bind(this))},paging:function(){var t=e.defer();return this.busy||this.page>this.pages?t.reject():(this.opened=null,this.get(t)),t.promise},refresh:function(){var t=e.defer();return this.busy?t.reject():(this.flush(),this.get(t)),t.promise},more:function(){var t=e.defer();return this.busy||this.page+1>this.pages?t.reject():(this.page++,this.get(t,!0)),t.promise},filter:function(){this.page=1,this.pages=s,this.paging()},prevPage:function(){var e=this.page-1;e>0&&e<=this.pages&&(this.page=e,this.paging())},nextPage:function(){var e=this.page+1;e>0&&e<=this.pages&&(this.page=e,this.paging())},gotoPage:function(e){e>0&&e<=this.pages&&(this.page=e,this.paging())},firstPage:function(){1!==this.page&&(this.page=1,this.paging())},lastPage:function(){this.page!==this.pages&&(this.page=this.pages,this.paging())},hasMany:function(){return this.count>0&&this.pages>this.maxPages},hasMorePagesBehind:function(){var e=Math.max(0,this.page-this.maxPages);return e>0},hasMorePagesNext:function(){var e=Math.max(0,this.page-this.maxPages)+this.maxPages;return e<this.pages},isPage:function(e){return this.page===e},hasPages:function(){return this.pages>0&&this.pages<s},getPages:function(){var e,t=[];if(this.hasPages()){var n=Math.max(0,this.page-this.maxPages),r=Math.min(this.pages,n+this.maxPages);for(e=n;r>e;)t.push({number:e+1}),e++}return t},openClose:function(e){this.opened===e?this.opened=null:this.opened=e}},i}]),app.factory("IndexedDataFilter",[function(){function e(e){e?angular.extend(this,e):null}return e.prototype={getSearchParams:function(e){var t=[];if(e)for(var n in e)t.push({name:n,value:e[n]});return t},getParams:function(e,t){var n,r={};for(var o in this)"dateFrom"===o||"dateTo"===o||"status"===o?(n=this[o],void 0!==n&&(r[o]=n)):"search"===o&&(r[o]=JSON.stringify(this.getSearchParams(this[o]),null,""));return r.page_index=e.page,r.page_size=e.size,r}},e}]),app.factory("IndexedDataSource",["$q","$http","$httpAsync","$timeout","$rootScope","IndexedDataFilter","APP",function(e,t,n,r,o,a,i){function s(e){this.busy=!1,this.error=!1,this.size=10,this.maxPages=10,this.rows=[],this.filters={},this.service={url:"/api/items/paging",resolve:function(e,t){angular.forEach(e,function(e){this.push(e)},t)}},e?angular.extend(this,e):null,this.filters=new a(this.filters),this.service.uri.paging===!1&&(this.get=function(e,t){this.busy=!0,this.error=!1,r(function(){t?null:this.rows.length=0,this.service.resolve(this.rows),this.page=1,this.pages=2,this.count=this.rows.length,this.pagination=this.getPages(),this.busy=!1,o.$broadcast("onIndexedDataSourceUpdate",this),e.resolve(this.rows)}.bind(this),1e3)}),this.flush()}var u=Number.POSITIVE_INFINITY;return s.prototype={flush:function(){this.pages=u,this.page=0,this.count=0,this.opened=null},resolve:function(e){e&&e.data?(this.count=e.data.count,this.pages=Math.ceil(this.count/this.size)):(this.page=0,this.pages=0,this.count=0),this.pagination=this.getPages()},get:function(e,n){this.busy=!0,this.error=!1;var a=this.service.uri.paging.split("##userId##").join(i.USER.id);t.get(a,{params:this.filters.getParams(this)}).then(function(t){this.resolve(t),n?null:this.rows.length=0,this.service.resolve(t.data.list,this.rows),o.$broadcast("onIndexedDataSourceUpdate",this),e.resolve(this.rows)}.bind(this),function(t){console.log("IndexedDataSource.error",t),this.error=!0,e.reject(t)}.bind(this))["finally"](function(){r(function(){this.busy=!1}.bind(this),1e3)}.bind(this))},paging:function(){var t=e.defer();return this.busy||this.page>=this.pages?t.reject():(this.opened=null,this.get(t)),t.promise},refresh:function(){var t=e.defer();return this.busy?t.reject():(this.flush(),this.get(t)),t.promise},more:function(){var t=e.defer();return this.busy||this.page+1>=this.pages?t.reject():(this.page++,this.get(t,!0)),t.promise},filter:function(){this.page=1,this.pages=u,this.paging()},prevPage:function(){var e=this.page-1;e>=0&&e<this.pages&&(this.page=e,this.paging())},nextPage:function(){var e=this.page+1;e>=0&&e<this.pages&&(this.page=e,this.paging())},gotoPage:function(e){e>=0&&e<this.pages&&(this.page=e,this.paging())},firstPage:function(){0!==this.page&&(this.page=0,this.paging())},lastPage:function(){this.page!==Math.max(0,this.pages-1)&&(this.page=Math.max(0,this.pages-1),this.paging())},hasMany:function(){return this.count>0&&this.pages>this.maxPages},hasMorePagesBehind:function(){var e=Math.max(0,this.page-this.maxPages);return e>0},hasMorePagesNext:function(){var e=Math.max(0,this.page-this.maxPages)+this.maxPages;return e<this.pages},isPage:function(e){return this.page+1===e},hasPages:function(){return this.pages>0&&this.pages<u},getPages:function(){var e,t=[];if(this.hasPages()){var n=Math.max(0,this.page-this.maxPages),r=Math.min(this.pages,n+this.maxPages);for(e=n;r>e;)t.push({number:e+1}),e++}return t},openClose:function(e){this.opened===e?this.opened=null:this.opened=e}},s}]),app.factory("TabsProvider",["Collection",function(e){var t=e.extend({init:function(){this.current=0},isIndex:function(e){return this.current===e},setIndex:function(e){e>=0&&e<this.length&&(this.current=e)},isValue:function(e){return this[this.current].value===e},setValue:function(e){var t=this.indexOfValue(e);-1!==t&&(this.current=t)},indexOfValue:function(e){for(var t=-1,n=0,r=this.length;r>n;){if(this[n].value===e){t=n;break}n++}return t}});return t}]),app.factory("ListProvider",["Collection",function(e){var t=e.extend({init:function(){},stringOfValues:function(e){for(var t="",n=0,r=this.length;r>n;)t+=(n>0?", ":"")+this[n][e],n++;return t},indexOfValue:function(e){for(var t=-1,n=0,r=this.length;r>n;){if(this[n].value===e){t=n;break}n++}return t},toString:function(){return this.stringOfValues("name")}});return t}]),app.factory("Collection",[function(){function e(){var e=Object.create(Array.prototype);return e=Array.apply(e,arguments)||e,this.constructor.inject(e),e.init(),e}return e.inject=function(e){for(var t in this.prototype)this.prototype.hasOwnProperty(t)&&(e[t]=this.prototype[t]);return e},e.extend=function(t){var n=function(){return e.apply(this,arguments)};return angular.extend(n,this),n.prototype=angular.extend({},this.prototype,t),n.prototype.constructor=n,n},e.__extend=function(e,t){return angular.extend(e,this),e.prototype=angular.extend({},this.prototype,t),e.prototype.constructor=e,e},e.fromArray=function(t){var n=e.apply(null,t);return n},e.isArray=function(e){var t=Object.prototype.toString.call(e);return"[object array]"===t.toLowerCase()},e.prototype={constructor:e,init:function(){},add:function(t){if(e.isArray(t))for(var n=0;n<t.length;n++)Array.prototype.push.call(this,t[n]);else Array.prototype.push.call(this,t);return this},addAll:function(){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}},e}]),app.factory("ExtensibleObject",[function(){function e(e){e?this.set(e):null}return e.prototype={set:function(e){angular.extend(this,e),this.init()},init:function(){console.log("ExtensibleObject.init")}},e.extend=function(e,t){return angular.extend(e,this),e.prototype=angular.extend(Object.create(this.prototype),t),e.prototype.constructor=e,e},e.prototype.constructor=e,e}]),app.factory("Cookie",["$q","$window",function(e,t){function n(){}return n.TIMEOUT=3e5,n._set=function(e,n,r){if(r){var o=new Date;o.setTime(o.getTime()+24*r*60*60*1e3);var a="; expires="+o.toGMTString();
}else var a="";t.document.cookie=e+"="+n+a+"; path=/"},n.set=function(e,t,r){try{var o=[],a=JSON.stringify(t,function(e,t){if("pool"!==e){if("object"==typeof t&&null!==t){if(-1!==o.indexOf(t))return;o.push(t)}return t}});o=null,n._set(e,a,r)}catch(i){console.log("Cookie.set.error serializing",e,t,i)}},n.get=function(e){for(var n=e+"=",r=t.document.cookie.split(";"),o=0;o<r.length;o++){for(var a=r[o];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(n)){var i=a.substring(n.length,a.length),s=null;try{s=JSON.parse(i)}catch(u){console.log("Cookie.get.error parsing",key,u)}return s}}return null},n["delete"]=function(e){n._set(e,"",-1)},n.on=function(t){function r(){if(s>u)a.reject("timeout");else{var e=n.get(t);e?a.resolve(e):(s+=i,o=setTimeout(r,i))}}var o,a=e.defer(),i=1e3,s=0,u=n.TIMEOUT;return r(),a.promise},n}]),app.factory("LocalStorage",["$q","$window","Cookie",function(e,t,n){function r(){}function o(){var e=!1;try{e="localStorage"in t&&null!==t.localStorage,e?(t.localStorage.setItem("test","1"),t.localStorage.removeItem("test")):e=!1}catch(n){e=!1}return e}return r.isSupported=o(),r.isSupported?(r.set=function(e,n){try{var r=[],o=JSON.stringify(n,function(e,t){if("pool"!==e){if("object"==typeof t&&null!==t){if(-1!==r.indexOf(t))return;r.push(t)}return t}});r=null,t.localStorage.setItem(e,o)}catch(a){console.log("LocalStorage.set.error serializing",e,n,a)}},r.get=function(e){var n=null;if(void 0!==t.localStorage[e])try{n=JSON.parse(t.localStorage[e])}catch(r){console.log("LocalStorage.get.error parsing",e,r)}return n},r["delete"]=function(e){t.localStorage.removeItem(e)},r.on=function(r){function o(e){if(clearTimeout(a),e.originalEvent.key==r)try{var t=JSON.parse(e.originalEvent.newValue);i.resolve(t)}catch(e){console.log("LocalStorage.on.error parsing",r,e),i.reject("error parsing "+r)}}var a,i=e.defer(),s=n.TIMEOUT;return angular.element(t).on("storage",o),a=setTimeout(function(){i.reject("timeout")},s),i.promise}):(console.log("LocalStorage.unsupported switching to cookies"),r.set=n.set,r.get=n.get,r["delete"]=n["delete"],r.on=n.on),r}]),app.factory("WebWorker",["$q","$http",function($q,$http){function WebWorker(e){var t=this;this.callbacks={},this.id=0,this.worker=new Worker(e),this.worker.onmessage=function(e){t.onmessage(e)}}var isWebWorkerSupported="undefined"!=typeof Worker;return isWebWorkerSupported||(window.Worker=function(){function Worker(src){var self=this;$http.get(src,{transformResponse:function(e,t){return e}}).then(function success(response){try{eval("self.o = function(){ function postMessage(e) { self.onmessage({data:e}); }\n "+response.data+" };"),self.object=new self.o,self.object.postMessage=function(e){self.onmessage({data:e})}}catch(e){console.log("Worker error ",e)}},function(e){console.log("Worker not found")})}return Worker.prototype={onmessage:function(e){console.log("Worker not implemented")},postMessage:function(e){this.object.onmessage({data:e})}},Worker}()),WebWorker.prototype={parse:function(e){return JSON.parse(e.data)},stringify:function(e){return JSON.stringify(e)},onmessage:function(e){var t=this.parse(e),n=this.callbacks[t.id];-1!==t.status?n.resolve(t):n.reject(t),delete this.callbacks[t.id]},post:function(e){var t=$q.defer();return e.id=this.id,this.callbacks[this.id.toString()]=t,this.id++,this.worker.postMessage(this.stringify(e)),t.promise}},WebWorker.isSupported=isWebWorkerSupported,WebWorker}]),app.factory("$httpAsync",["$q","$http",function(e,t){function n(t){var r=e.defer(),o=u(t);return o.id=p.toString(),h[o.id]=r,p++,l.postMessage(n.stringify(o)),r.promise}function r(e){return e>=200&&300>e}function o(){return Object.create(null)}function a(e){return"string"==typeof e}function i(e){function t(e,t){e&&(r[e]=r[e]?r[e]+", "+t:t)}var n,r=o();if(a(e))for(var i=e.split("\n"),s=0;s<i.length;s++){var u=i[s];n=u.indexOf(":"),t(f(g(u.substr(0,n))),g(u.substr(n+1)))}else if(isObject(e))for(var c in e)t(f(c),g(e[c]));return r}function s(e){var t;return function(n){if(t||(t=i(e)),n){var r=t[f(n)];return void 0===r&&(r=null),r}return t}}function u(e){var n={method:"GET",withCredentials:!1,responseType:"json",headers:{},config:{}};n.withCredentials=t.defaults.withCredentials,angular.extend(n.headers,t.defaults.headers.common);var r=(e.method||n.method).toLowerCase();return t.defaults.headers[r]&&angular.extend(n.headers,t.defaults.headers[r]),e?e=angular.extend(n,e):n,e}var c="undefined"!=typeof Worker;if(!c)return t;var l=new Worker("/Scripts/app/workers/http.js"),h={},p=0,f=function(e){return a(e)?e.toLowerCase():e},g=function(e){return a(e)?e.trim():e};return n.get=function(e,t){return n(angular.extend({},t||{},{method:"GET",url:e}))},n["delete"]=function(e,t){return n(angular.extend({},t||{},{method:"DELETE",url:e}))},n.head=function(e,t){return n(angular.extend({},t||{},{method:"HEAD",url:e}))},n.post=function(e,t,r){return n(angular.extend({},r||{},{method:"POST",data:t,url:e}))},n.put=function(e,t,r){return n(angular.extend({},r||{},{method:"PUT",data:t,url:e}))},n.patch=function(e,t,r){return n(angular.extend({},r||{},{method:"PATCH",data:t,url:e}))},n.parse=function(e){return JSON.parse(e.data)},n.stringify=function(e){return JSON.stringify(e)},n.isSupported=c,l.onmessage=function(e){var t=n.parse(e),o=h[t.id],a=t.status>=-1?t.status:0,i=s(t.response.headers);(r(a)?o.resolve:o.reject)({data:t.response.data,headers:i,status:t.response.status,statusText:t.response.statusText,config:t.config}),delete h[t.id]},n}]),app.controller("RootCtrl",["$scope","$route","$location","Config",function(e,t,n,r){console.log("RootCtrl"),e.config=r}]),app.controller("HomeCtrl",["$scope","$route","$location",function(e,t,n){console.log("HomeCtrl")}]),app.controller("AboutCtrl",["$scope","$route","$location",function(e,t,n){console.log("AboutCtrl")}]),app.controller("ContactCtrl",["$scope","$route","$location",function(e,t,n){console.log("ContactCtrl")}]);
//# sourceMappingURL=app.min.js.map
